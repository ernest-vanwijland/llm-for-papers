\documentclass[a4paper]{article}

\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\allowdisplaybreaks

\setlength{\textheight}{195mm}
\setlength{\textwidth}{125mm}

\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}[proposition]{Lemma}
\newtheorem{corollary}[proposition]{Corollary}
\newtheorem{theorem}[proposition]{Theorem}
\newtheorem{conjecture}[proposition]{Conjecture}
\theoremstyle{definition}
\newtheorem{definition}[proposition]{Definition}
\newtheorem{example}[proposition]{Example}
\newtheorem{remark}[proposition]{Remark}
\numberwithin{equation}{section}
\newtheorem*{example*}{Example}

\begin{document}

\begin{center}
\LARGE
\textbf{Writing finite simple groups of Lie type \\ as products of subset conjugates}
\bigskip\bigskip

\large
Daniele Dona
\bigskip

\normalsize
HUN-REN Alfr\'ed R\'enyi Institute of Mathematics

Re\'altanoda utca 13-15, Budapest 1053, Hungary

\texttt{dona@renyi.hu}
\bigskip\medskip
\end{center}

\begin{minipage}{110mm}
\small
\textbf{Abstract.} The Liebeck-Nikolov-Shalev conjecture \cite{LNS12} asserts that, for any finite simple non-abelian group $G$ and any set $A\subseteq G$ with $|A|\geq 2$, $G$ is the product of at most $N\frac{\log|G|}{\log|A|}$ conjugates of $A$, for some absolute constant $N$.

For $G$ of Lie type, we prove that for any $\varepsilon>0$ there is some $N_{\varepsilon}$ for which $G$ is the product of at most $N_{\varepsilon}\left(\frac{\log|G|}{\log|A|}\right)^{1+\varepsilon}$ conjugates of either $A$ or $A^{-1}$. For symmetric sets, this improves on results of Liebeck, Nikolov, and Shalev \cite{LNS12} and Gill, Pyber, Short, and Szab\'o \cite{GPSS13}.

During the preparation of this paper, the proof of the Liebeck-Nikolov-Shalev conjecture was completed by Lifshitz \cite{Lif24}. Both papers use \cite{GLPS24} as a starting point. Lifshitz's argument uses heavy machinery from representation theory to complete the conjecture, whereas this paper achieves a more modest result by rather elementary combinatorial arguments.
\medskip

\textbf{Keywords.} Growth, conjugacy, finite simple groups.
\medskip

\textbf{MSC2020.} 20D06, 20F69, 20G40.
\end{minipage}
\medskip

\section{Introduction}

An important general question at the crossroad between finite group theory and combinatorics is whether we can represent a group $G$ as the product of few copies of a subset $A$ of $G$. The topic goes back at least to the first formulation of Babai's conjecture \cite{BS88}.

When we allow ourselves to take the product of conjugates of $A$, rather than of copies of $A$ itself, the number of necessary conjugates was generally expected to be very small, essentially the smallest possible up to multiplicative constant. This is the content of the conjecture below, due to Liebeck, Nikolov, and Shalev \cite{LNS12}.

\begin{conjecture}\label{co:conjlns}
There exists $N$ such that, for all finite simple groups $G$ and all subsets $A\subseteq G$ with $|A|\geq 2$, $G$ is the product of at most $N\frac{\log|G|}{\log|A|}$ conjugates of $A$.
\end{conjecture}

The conjecture generalizes a slightly earlier one by the same authors, where $A$ is a subgroup of $G$ rather than a subset \cite{LNS10}.

Many partial results have been known for years. The following two are relevant for us, in that they hold for all $G$ of Lie type and all $A$: the number of conjugates inside the product can be bounded by
\begin{align}
\left(\frac{\log|G|}{\log|A|}\right)^{N(r)} & \text{\ \ \ \ \ by \cite[Thm.~1]{LNS12},} \label{eq:boundlns} \\
N(r)\frac{\log|G|}{\log|A|} & \text{\ \ \ \ \ by \cite[Thm.~1.3]{GPSS13},} \label{eq:boundgpss}
\end{align}
where in both cases $N(r)$ is a function of the rank $r$ of $G$.

In an independent and far-reaching work that appeared during the preparation of this paper, Lifshitz \cite{Lif24} managed to complete the proof of Conjecture~\ref{co:conjlns}. For the Lie type case, Lifshitz's paper uses heavy machinery from character theory, stemming from Deligne-Lusztig theory (in the form of a recent character bound from Larsen and Tiep \cite{LT24}) and from the generalized Frobenius formula of \cite{GLPS24}.

Our main result is more modest in several ways than Conjecture~\ref{co:conjlns}. However, the proof relies on combinatorial arguments that are surprisingly quite elementary, much more than in \cite{Lif24}, and it may be of independent interest to see how far one can go with elementary tools.

\begin{theorem}\label{th:main}
For any $0<\varepsilon\leq\frac{1}{2}$ there exists $N_{\varepsilon}$ such that the following holds. Let $G$ be a finite simple group of Lie type, and let $A\subseteq G$ with $|A|\geq 2$. Then $G$ is the product of at most
\begin{equation*}
N_{\varepsilon}\left(\frac{\log|G|}{\log|A|}\right)^{1+\varepsilon}
\end{equation*}
conjugates of either $A$ or $A^{-1}$.
\end{theorem}

When $A$ is symmetric (for instance when $A$ is a subgroup), the result improves considerably on \eqref{eq:boundlns}. As observed by L.~Pyber (personal communication), Theorem~\ref{th:main} can be reformulated to directly improve \eqref{eq:boundgpss} as well: see Remark~\ref{re:pyber} for proof and comparisons.
\medskip

\textit{Note on chronology.} The result of this paper was already privately proved in August 2023, before the completion of the stronger work of Lifshitz \cite{Lif24}, and it was made privately available to L.~Pyber in January 2024. This paper ended up appearing publicly only after \cite{Lif24}. Both \cite{Lif24} and this paper depend on \cite{GLPS24}, in the latter case through Theorem~\ref{th:ptc}. No wrongful conduct can be ascribed to N.~Lifshitz, who was not yet a coauthor of \cite{GLPS24} in January 2024 and was unaware of the author's work until after the appearance of \cite{Lif24} in August 2024.

\section{Strategy}

Let us give here a general overview of our strategy. Throughout the paper, $r$ is the (untwisted) rank of $G$ and $q$ is the size of the base field of $G$. We want the set $A$ to ``grow quickly'' all the way to $G$, where with ``growing quickly'' we mean that we can find a product $X$ of $N$ conjugates of either $A$ or $A^{-1}$ where $|X|$ is particularly large; the optimal growth would be $|A|^{N}$ by order considerations, and we aim for not much less than that. With some caution, we are allowed to grow in several spurts: we can use one technique or result to make $A$ grow up to reaching a product $A'$ larger than some threshold, then make $A'$ grow using a different technique or result until we reach a product $A''$ larger than some second threshold, and so on.

Until $|A|$ is around $q^{r}$ we know that we grow very quickly (Proposition~\ref{pr:smallgrow}). A version of the product theorem valid up to conjugation (Theorem~\ref{th:ptc}) can make us grow for short intervals, such as from $q^{r}$ to $q^{Cr}$ and from $q^{r^{2}/C}$ to $|G|$ for any fixed constant $C$. The name ``product theorem'' comes from analogous results in the context of Babai's conjecture, such as the ones in \cite{Hel08} \cite{BGT11} \cite{PS16} \cite{BDH21}; such results already appear in the literature related to Conjecture~\ref{co:conjlns}, as they are used in the proof of \eqref{eq:boundlns}.

It remains to deal with growth from $q^{Cr}$ to $q^{r^{2}/C}$, which forms the main and novel part of our proof. Since the number of conjugacy classes is only $q^{4r}$ (Proposition~\ref{pr:fewclass}), in this interval we can assume to be working with subsets of conjugacy classes without losing too much of the size of $A$.

Two cases arise at this point: either our set $A$ (or rather $A^{-1}A$ or $AA^{-1}$, for technical reasons) occupies a large chunk of a conjugacy class, or it does not. In the former case, since we already know that classes grow quickly (Theorem~\ref{th:dmp}), we can make the large subset inherit the same growth rate: this is the content of \S\ref{se:xcldelta}, and the growth we achieve here is compatible not only with Theorem~\ref{th:main} but even with Conjecture~\ref{co:conjlns}. In the latter case, when $A$ occupies a small chunk of every class, there is enough manoeuvring space to produce a conjugate of $A$ completely disjoint from $A$; with such a conjugate in hand, we grow by standard arguments. In \S\ref{se:main} we tackle this second case and prove the main theorem.

We mention that many of the techniques, taken one by one, are applicable to more general groups. The pecularity of finite simple groups of Lie type is that the various pieces fit together to form a complete proof. To make an example, for $G=\mathrm{Alt}(n)$ there is a much wider gap between the size of the smallest conjugacy class and the number of conjugacy classes, in the ballpark of $n^{2}$ and $e^{\sqrt{n}}$ respectively, whereas for $G$ of Lie type we have $q^{r}$ and $q^{4r}$; therefore, a result like Theorem~\ref{th:ptc} would not be enough in $\mathrm{Alt}(n)$ to bridge the gap between Proposition~\ref{pr:smallgrow} and the main part of our strategy.

\section{Tools}

We start by quoting some group-theoretic results about finite simple groups of Lie type. First we have a lower bound on the size of any nontrivial conjugacy class: the following is \cite[Prop.~2.3]{GPSS13}, which relies on \cite[\S 5]{KL90}.

\begin{proposition}\label{pr:qnclass}
Let $G$ be a finite simple group of Lie type of rank $r$ over $\mathbb{F}_{q}$. Then $|G|\leq q^{8r^{2}}$, and every nontrivial conjugacy class $C$ has size $|C|\geq q^{r}$.
\end{proposition}

We also need an upper bound on the number of conjugacy classes. The following is \cite[Thm.~1]{LP97}.

\begin{proposition}\label{pr:fewclass}
Let $G$ be a finite simple group of Lie type of rank $r$ over $\mathbb{F}_{q}$. There are $\leq(6q)^{r}\leq q^{4r}$ conjugacy classes in $G$.
\end{proposition}

Now we list several results more specifically about growth in $G$. First, we do not have to worry about the case of bounded rank thanks to the result below, which comes from \cite[Thm.~1.3]{GPSS13}.

\begin{theorem}\label{th:boundr}
Fix $r_{0}$, and let $G$ be a finite simple group of Lie type of rank $\leq r_{0}$. Conjecture~\ref{co:conjlns} holds for this $G$, with $N$ depending on $r_{0}$.
\end{theorem}

The growth is already known to be as fast as possible for small sets, at least until we reach a size comparable to the smallest conjugacy class, as shown below.

\begin{proposition}\label{pr:smallgrow}
Let $G$ be a finite simple group of Lie type of rank $r$ over $\mathbb{F}_{q}$, and let $S\subseteq G$ with $|S|\geq 2$. There are some positive integer $m$ and some set $X$ with
\begin{align*}
X & =S^{h_{1}}S^{h_{2}}\ldots S^{h_{m}} \ \ (h_{i}\in G), & |X| & =|S|^{m}\geq\frac{q^{\frac{1}{2}r}}{|S|}.
\end{align*}
\end{proposition}

\begin{proof}\textcolor{red}{TOPROVE 0}\end{proof}

For $G$ of Lie type and $S\subseteq G$, we can also find a product $SS^{g}$ growing exponentially in size. This is \cite[Thm.~1.6]{GLPS24}, improving on \cite[Thm.~1.4]{GPSS13}, which as we mentioned is analogous to results called ``product theorems'' in the context of Babai's conjecture.

\begin{theorem}\label{th:ptc}
There are absolute constants $\tau>0$ and $b$ such that, for any finite simple non-abelian group $G$ and any subset $S\subseteq G$ with $|S|\geq 2$, either
\begin{enumerate}[(1)]
\item there is $g\in G$ with $|SS^{g}|\geq|S|^{1+\tau}$, or
\item $G$ is the product of $\leq b$ conjugates of $S$.
\end{enumerate}
\end{theorem}

One can prove a version of the above using two distinct sets, provided that one of them is normal; the growth in this case is exceptionally fast. The result below is \cite{DMP24}.

\begin{theorem}\label{th:dmp}
For any $\varepsilon>0$ there exists $\eta=\eta(\varepsilon)>0$ such that, for any finite simple non-abelian group $G$, any subset $A\subseteq G$, and any normal subset $B\subseteq G$, if $|A|,|B|\leq|G|^{\eta}$ then $|AB|\geq|A||B|^{1-\varepsilon}$.
\end{theorem}

\begin{remark}
The result in \cite{DMP24} for groups of Lie type is proved using both an estimate of the size of small conjugacy classes of $G$, based on \cite[\S\S 3-4]{LS12} through \cite[\S 3]{LSS17}, and a non-abelian version of Pl\"unnecke's inequality that appeared in \cite[Thm.~4.1]{GPSS13}. One can prove a special case of Theorem~\ref{th:dmp} for groups of unbounded rank and for $A,B$ both conjugacy classes by using only the size estimates. The proof is more computationally cumbersome, but it relies on a nice structural resemblance between the size of $G$ and the size of a centralizer that may be of interest to the reader, and the case of conjugacy classes is all we need for this paper. 

Call $n_{i}(x,\lambda)$ the number of Jordan blocks $J_{i}(\lambda)$ of eigenvalue $\lambda\in\overline{\mathbb{F}_{q}}$ and size $i\geq 1$ appearing in the Jordan form of $x\in\mathrm{GL}_{n}(q)$. In particular, $n=\sum_{\lambda}\sum_{i}in_{i}(x,\lambda)$. Using for instance \cite[p.~3054]{FG12} for $\mathrm{SL}_{n}$ and \cite[pp.~34-36-39]{Wal63} for $\mathrm{SU}_{n},\mathrm{Sp}_{n},\mathrm{SO}_{n}^{\pm}$, one shows that $|G|\sim_{n}q^{\dim(G)}$ and $|C_{G}(x)|\sim_{n} q^{m}$ (hiding constants depending only on $n$) with
\begin{center}
\def\arraystretch{1.3}
\begin{tabular}{|c||c|c|}\hline
$G$ & $\dim(G)$ & $m$ \\ \hline\hline
$\mathrm{SL}_{n}(q),\mathrm{SU}_{n}(q)$ & $n^{2}-1$ & $R-1$ \\ \hline
$\mathrm{Sp}_{n}(q)$ & $\frac{1}{2}(n^{2}+n)$ & $\frac{1}{2}(R+S)$ \\ \hline
$\mathrm{SO}_{n}^{\pm}(q)$ & $\frac{1}{2}(n^{2}-n)$ & $\frac{1}{2}(R-S)$ \\ \hline
\end{tabular}
\end{center}
where
\begin{align*}
R & =\sum_{\lambda}\sum_{i}\left(in_{i}(x,\lambda)^{2}+2\sum_{i'>i}in_{i}(x,\lambda)n_{i'}(x,\lambda)\right), & S & =\sum_{\lambda=\pm 1}\sum_{\text{$i$ odd}}n_{i}(x,\lambda).
\end{align*}
Then, for any $x$ having a small class, there is a special eigenvalue $\lambda_{x}$ for which $n_{1}(x,\lambda_{x})\geq\frac{1}{2}n$, and for any two such $x_{1},x_{2}$ there is $y\in\mathrm{Cl}(x_{1})\mathrm{Cl}(x_{2})$ with $\lambda_{y}=\lambda_{x_{1}}\lambda_{x_{2}}$ and
\begin{align*}
n_{1}(y,\lambda_{y}) & =n_{1}(x_{1},\lambda_{x_{1}})+n_{1}(x_{2},\lambda_{x_{2}})-n, & & \\
n_{i}(y,\lambda) & =n_{i}(x_{1},\lambda\lambda_{x_{2}}^{-1})+n_{i}(x_{2},\lambda\lambda_{x_{1}}^{-1}) & & \text{for $(\lambda,i)\neq(\lambda_{y},1)$.}
\end{align*}
Putting appropriately together all the estimates, the conclusion is that $|\mathrm{Cl}(y)|\gtrsim_{n}|\mathrm{Cl}(x_{1})||\mathrm{Cl}(x_{2})|^{1-\varepsilon}$ for $|\mathrm{Cl}(x_{1})|,|\mathrm{Cl}(x_{2})|\leq|G|^{\eta}$. The dependence is also explicit: taking $\eta=\frac{\varepsilon}{100}$ is more than enough.
\end{remark}

\section{The case $|X|\geq|C|^{\delta}$}\label{se:xcldelta}

We tackle separately the case of a subset $X$ of a conjugacy class $C$ for which $|X|\geq|C|^{\delta}$. This situation is particularly favourable, with a resulting growth compatible even with Conjecture~\ref{co:conjlns} itself. We shall use the conclusion of this section in the main proof, imposing quite arbitrarily $\delta=\frac{1}{4}$.

The idea is quite simple. Since we know that by Theorem~\ref{th:dmp} we can achieve fast growth using a normal subset, such as the class $C$, we only need to show that our large set $X$ inherits this behaviour from $C$. To do so, we use elementary combinatorial lemmas to prove that there is a rather sparse cover of $C$ by conjugates of $X$; then, since the cover is sparse, at least one of the conjugates must grow fast as well.

We start by proving that we can take any two sets in $C$ and separate them enough by conjugation.

\begin{lemma}\label{le:piececl}
Let $G$ be a finite group, and let $C\subseteq G$ be a conjugacy class. Then, for any two proper subsets $S,T\subsetneq C$, there is some $g\in G$ with $|S^{g}\cap T|\leq\min\left\{|S|-1,|S|\frac{|T|}{|C|}\right\}$.
\end{lemma}

\begin{proof}\textcolor{red}{TOPROVE 1}\end{proof}

Using the separation lemma above, we find a cover of $C$ made of conjugate sets. The cover is sparse in the sense that it is only a logarithmic factor away from the best possible cover, i.e.\ a partition.

\begin{lemma}\label{le:covercl}
Let $G$ be a finite group, and let $C\subseteq G$ be a conjugacy class. Then, for any subset $S\subseteq C$ with $|S|\geq 2$, there is some set $H\subseteq G$ with $|H|\leq\frac{6|C|\log|S|}{|S|}$ such that $\bigcup_{h\in H}S^{h}=C$.
\end{lemma}

\begin{proof}\textcolor{red}{TOPROVE 2}\end{proof}

\begin{remark}
As pointed out by S.~Skresanov (personal communication), the nontrivial part of Lemma~\ref{le:piececl} is already in \cite[Lemma 2]{DeV23}, which in turn is a variation of old counting arguments by Babai \cite{Bab80c}. He also remarked that a much shorter probabilistic argument already gives $|H|\leq\left\lfloor\frac{|C|\log|C|}{|S|}\right\rfloor+1$ in Lemma~\ref{le:covercl}: for a fixed $x$ and random $h_{1},\ldots,h_{t}$ the probability that $x$ does not lie in $S^{h_{1}},\ldots,S^{h_{t}}$ is bounded by $e^{-t|S|/|C|}$, and it suffices to take $t>\frac{|C|\log|C|}{|S|}$ to have $|C|e^{-t|S|/|C|}<1$. The resulting bound for $|H|$ is weaker than in Lemma~\ref{le:covercl}, but not enough to affect our future arguments.
\end{remark}

Combining the cover lemma above with the growth result of Theorem~\ref{th:dmp}, we obtain the result we want for $|X|\geq|C|^{\delta}$.

\begin{proposition}\label{pr:xcldelta}
Fix $0<\delta\leq 1$ and $\eta=\eta\left(\frac{\delta}{10}\right)$, where the function $\eta$ is as in Theorem~\ref{th:dmp}. Let $G$ be a finite simple group of Lie type of rank $r$ over $\mathbb{F}_{q}$, let $C\subseteq G$ be a nontrivial conjugacy class with $q^{10r/\delta}\leq|C|\leq|G|^{\eta}$, and let $X\subseteq C$ with $|X|\geq|C|^{\delta}$. Then $G$ is the product of at most $N\frac{\log|G|}{\log|X|}$ conjugates of $X$, where $N$ depends only on $\delta$.
\end{proposition}

\begin{proof}\textcolor{red}{TOPROVE 3}\end{proof}

\section{The main theorem}\label{se:main}

We move to the proof of the main theorem.

The idea is essentially the following (we simplify the description avoiding technicalities, so as to capture the spirit of the proof at the expense of precision). Thanks to \S\ref{se:xcldelta}, we already know what happens when our set occupies a large part of a conjugacy class, so we need to deal with the converse case. Whenever we have a set $S$ whose intersection with every class is small, there is a conjugate $S^{g}$ whose intersection with $S$ is empty. Then growth is achieved by standard tricks in map counting, similar to \cite[Lemma 2.2]{Hel19b} for instance. We then pass from $S$ to $SS^{g}$, and repeat the process, checking whether the new set has large intersection with a class or not and so on.

It is at this point that we fail to reach Conjecture~\ref{co:conjlns} and we have to settle for the exponent $1+\varepsilon$ in Theorem~\ref{th:main}. The dichotomy between the case of \S\ref{se:xcldelta} and its converse relies on the fact that the set and the class are not too far apart in size. To satisfy this condition at every step, we need to get rid of some of the elements of each new $S$, in order to avoid that the class with large intersection is too small. Thus, in the statement of Lemma~\ref{le:xclsmall} there is a discrepancy between the fact that $X'$ is contained in the product of two conjugates of $X$ and the fact that its size is $|X|^{2-\varepsilon}$ in the worst case; this discrepancy comes from the denominator $|T|+1$ in Lemma~\ref{le:cutsmall}, and in turn it leads in the end to the exponent $1+\varepsilon$.

We begin with the technical lemma that removes undesirable elements.

\begin{lemma}\label{le:cutsmall}
Let $G$ be a finite group, and let $S,T\subseteq G$ with $e\notin T=T^{-1}$. Then there is a subset $U\subseteq S$ with $|U|\geq\frac{|S|}{|T|+1}$ and $U^{-1}U\cap T=\emptyset$.
\end{lemma}

\begin{proof}\textcolor{red}{TOPROVE 4}\end{proof}

For a fixed group $G$ and a fixed $0<\varepsilon<1$, define the following two properties for any subset $X\subseteq G$:
\begin{align*}
P_{1}(X): & \text{ every conjugacy class $C\neq\{e\}$ with $|C|<|X|^{\frac{1}{3}\varepsilon}$ has $X^{-1}X\cap C=\emptyset$,} \\
P_{2}(X): & \text{ every conjugacy class $C\neq\{e\}$ with $|C|\geq|X|^{\frac{1}{3}\varepsilon}$ has $|X^{-1}X\cap C|<|C|^{\frac{1}{4}}$} \\
& \text{ and $|XX^{-1}\cap C|<|C|^{\frac{1}{4}}$.}
\end{align*}
In \S\ref{se:xcldelta} we dealt with $X$ satisfying $P_{1}(X)$ and not $P_{2}(X)$. Now we prove growth for $X$ satisfying both $P_{1}(X)$ and $P_{2}(X)$.

\begin{lemma}\label{le:xclsmall}
Let $0<\varepsilon<1$, and let $G$ be a finite simple group of Lie type. For any $X$ with $|X|\geq q^{100r/\varepsilon}$ such that $P_{1}(X),P_{2}(X)$ hold, there are some $g\in G$ and some $X'\subseteq XX^{g}$ with $|X'|\geq|X|^{2-\varepsilon}$ such that $P_{1}(X')$ holds.
\end{lemma}

\begin{proof}\textcolor{red}{TOPROVE 5}\end{proof}

The formulation of Lemma~\ref{le:xclsmall} now makes the induction process evident. At this point we have all the tools to prove the main theorem.

\begin{proof}\textcolor{red}{TOPROVE 6}\end{proof}

\begin{remark}\label{re:pyber}
As remarked by L.~Pyber (personal communication), the number of conjugates can also be bounded as
\begin{equation*}
N_{\varepsilon}r^{\varepsilon}\cdot\frac{\log|G|}{\log|A|}
\end{equation*}
where $r$ is the rank of $G$. In fact, observe that in our proof $|A_{2}|\geq q^{r}$ and that $|A_{4}|\leq|G|\leq q^{8r^{2}}$ by Proposition~\ref{pr:qnclass}, so inside \eqref{eq:finale} one can use the bound $\frac{\log|A_{4}|}{\log|A_{2}|}\leq 8r$.

This provides a more direct improvement to \eqref{eq:boundgpss}. In the proof of \cite[Thm.~1.3]{GPSS13}, the resulting function is of the form $N(r)=O(r^{e^{1/\varepsilon(r)}})$ where $\varepsilon(r)$ comes from using some version of the product theorem for Babai's conjecture. Depending on which version we use, one may obtain $1/\varepsilon(r)$ being: a non-explicit function \cite{BGT11}, a tower of exponential of height depending on $r$ \cite{PS16}, or a polynomial in $r$ for untwisted classical groups \cite{BDH21}. Furthermore, it is known by explicit counterexamples \cite[Ex.~77]{PS16} that passing through such theorems one cannot do better than $1/\varepsilon(r)$ linear in $r$. If we used Theorem~\ref{th:ptc} instead of product theorems as above, we would still obtain $N(r)=O(r^{N})$ for some constant $N$. In all cases, $N(r)=O_{\varepsilon}(r^{\varepsilon})$ as we have here is a better bound.
\end{remark}

\section*{Acknowledgements}

The author thanks several members of the R\'enyi Institute (A.~Mar\'oti, L.~Sabatini, S.~Skresanov, D.~Szab\'o) for discussions about the problem and its techniques, which helped improve the structure of the proof. The author was funded by a Young Researcher Fellowship from the R\'enyi Institute.

\bibliography{Bibliography}
\bibliographystyle{alpha}

\end{document}
